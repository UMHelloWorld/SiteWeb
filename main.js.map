{"version":3,"sources":["main.es6.js"],"names":[],"mappings":";;;;;;;;;;;;AAUA,OAAO,CAAC,SAAS,CAAC,CAAC;;AAEnB,IAAI,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AACjC,IAAI,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;;AAExC,IAAI,GAAG,GAAG,OAAO,EAAE,CAAC;;AAEpB,IAAI,KAAK,GAAQ,OAAO,CAAC,OAAO,CAAC,CAAC;AAClC,IAAI,UAAU,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,mBAAmB,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;AAChH,UAAU,CAAC,OAAO,EAAE,CAAC;;;AAGrB,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;AACnD,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC;;;AAG3B,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,UAAO,CAAC,SAAS,GAAG,SAAS,CAAC,CAAC,CAAC;;AAE1D,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,SAAS,GAAG,QAAQ,CAAC,CAAA;;AAEtC,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;;AAE/B,IAAI,KAAK,GAAG,CACX;AACC,IAAG,EAAE,OAAO;AACZ,KAAI,EAAE,MAAM;AACZ,MAAK,EAAE,SAAS;CAChB,EACD;AACC,IAAG,EAAE,UAAU;AACf,KAAI,EAAE,UAAU;AAChB,MAAK,EAAE,UAAU;CACjB,EACD;AACC,IAAG,EAAE,WAAW;AAChB,KAAI,EAAE,MAAM;AACZ,MAAK,EAAE,OAAO;CACd,EACD;AACC,IAAG,EAAE,UAAU;AACf,KAAI,EAAE,gBAAgB;AACtB,MAAK,EAAE,oBAAoB;CAC3B,EACD;AACC,IAAG,EAAE,SAAS;AACd,KAAI,EAAE,SAAS;AACf,MAAK,EAAE,WAAW;CAClB,CACD,CAAC;;AAEF,GAAG,CAAC,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;;AAEnD,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,UAAC,GAAG,EAAE,GAAG,EAAK;AAC1B,IAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;CACvB,CAAC,CAAC;;AAEH,IAAI,OAAO,GAAG;AACb,UAAS,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,qBAAqB,CAAC,CAAC,QAAQ,EAAE;CACvE,CAAC;;AAEF,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,UAAC,GAAG,EAAE,GAAG,EAAK;AAChC,QAAO,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AAC/B,WAAU,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,EAAE,UAAS,GAAG,EAAE,OAAO,EAAC;AACzD,SAAO,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AACrB,QAAM,CAAC,GAAG,EAAE,GAAG,EAAE,UAAU,EAAE;AAC5B,YAAS,EAAE,IAAI;AACf,YAAS,EAAE,IAAI;AACf,SAAM,EAAE,OAAO,CAAC,GAAG,CAAC,UAAA,CAAC;WACnB;AACA,OAAE,EAAE,CAAC,CAAC,CAAC,EAAE;AACT,iBAAY,EAAE,CAAC,CAAC,CAAC,YAAY;AAC7B,WAAM,EAAE,CAAC,CAAC,CAAC,MAAM;AACjB,UAAK,EAAE,CAAC,CAAC,KAAK;AACd,WAAM,EAAE,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC;AACzB,gBAAW,EAAE,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC;KACnC;IAAC,CACF;GACD,CAAC,CAAC;EACH,CAAC,CAAC;CACH,CAAC,CAAC;;AAEH,SAAS,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAC;AACtC,IAAG,CAAC,MAAM,CAAC,YAAY,EACtB;AACC,OAAK,EAAE,KAAK,CAAC,GAAG,CACf,UAAC,IAAI;UAAM;AACV,OAAG,EAAE,IAAI,CAAC,GAAG;AACb,SAAK,EAAE,IAAI,CAAC,KAAK;AACjB,QAAI,EAAE,IAAI,CAAC,IAAI;AACf,YAAQ,EAAG,IAAI,CAAC,GAAG,IAAE,IAAI,AAAC;IAC1B;GAAC,CACF;AACD,MAAI,EAAE,IAAI;AACV,QAAM,EAAE,MAAM,IAAI,EAAE;AACpB,KAAG,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;EAC3B,CACD,CAAC;CACF;;AAED,GAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAC,GAAG,EAAE,GAAG,EAAK;AAC/B,KAAG,GAAG,CAAC,MAAM,CAAC,IAAI,IAAE,UAAU,EAC7B,OAAO,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC/B,KAAG,KAAK,CAAC,IAAI,CAAC,UAAC,IAAI;SAAK,IAAI,CAAC,GAAG,IAAE,GAAG,CAAC,MAAM,CAAC,IAAI;EAAA,CAAC,EACjD,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,KAElC,GAAG,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;CACxB,CAAC,CAAC;;AAEH,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC","file":"main.es6.js","sourcesContent":["/*\n\tPour tester, lancer la commande \"babel-node main.es6.js\"\n\n\tIl faut avoir installé : \n\t - nodejs ;\n\t - npm ;\n\t - les modules listés dans package.json ;\n\t - babel\n\t - stylus\n*/\nrequire(\"core-js\");\n\nvar express = require('express');\nvar bodyParser = require('body-parser');\n\nvar app = express();\n\nvar mysql      = require('mysql');\nvar connection = mysql.createConnection(JSON.parse(require('fs').readFileSync('config-mysql.json').toString()));\nconnection.connect();\n\n//Pour les requêtes POST\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(bodyParser.json());\n\n//Le répertoire /static/ est considéré comme statique\napp.use(\"/static\", express.static(__dirname + \"/static\"));\n//Les vues sont stockées dans /views\napp.set('views', __dirname + '/views')\n//Les vues sont en jade, préprocesseur pour HTML\napp.set('view engine', 'jade');\n\nvar pages = [\n\t{\n\t\turl: 'index',\n\t\ticon: 'home',\n\t\ttitle: 'Accueil'\n\t},\n\t{\n\t\turl: 'calendar',\n\t\ticon: 'calendar',\n\t\ttitle: 'Planning'\n\t},\n\t{\n\t\turl: 'documents',\n\t\ticon: 'book',\n\t\ttitle: 'Cours'\n\t},\n\t{\n\t\turl: 'tutoring',\n\t\ticon: 'graduation-cap',\n\t\ttitle: 'Tutorat & entraide'\n\t},\n\t{\n\t\turl: 'sign-in',\n\t\ticon: 'sign-in',\n\t\ttitle: 'Connexion'\n\t},\n];\n\napp.use('/api', require('./api/main.js')(express));\n\napp.get('/', (req, res) => {\n\tres.redirect(\"/index\");\n});\n\nvar queries = {\n\tgetTopics: require('fs').readFileSync('./sql/getTopics.sql').toString()\n};\n\napp.get('/forum/', (req, res) => {\n\tconsole.log(queries.getTopics);\n\tconnection.query(queries.getTopics, function(err, results){\n\t\tconsole.log(results);\n\t\trender(req, res, 'tutoring', {\n\t\t\tshowForum: true,\n\t\t\tshowTopic: true,\n\t\t\ttopics: results.map(r => \n\t\t\t\t({\n\t\t\t\t\tid: +r.id,\n\t\t\t\t\tannotationId: +r.annotationId,\n\t\t\t\t\tuserId: +r.userId,\n\t\t\t\t\ttitle: r.title,\n\t\t\t\t\tsolved: Boolean(r.solved),\n\t\t\t\t\tvalidAnswer: Boolean(r.validAnswer)\n\t\t\t\t})\n\t\t\t)\n\t\t});\n\t});\n});\n\nfunction render(req, res, page, params){\n\tres.render(\"index.jade\", \n\t\t{\n\t\t\tpages: pages.map(\n\t\t\t\t(page) => ({\n\t\t\t\t\turl: page.url,\n\t\t\t\t\ttitle: page.title,\n\t\t\t\t\ticon: page.icon,\n\t\t\t\t\tisActive: (page.url==page)\n\t\t\t\t})\n\t\t\t),\n\t\t\tpage: page,\n\t\t\tparams: params || {},\n\t\t\tdbg: JSON.stringify(params)\n\t\t}\n\t);\n}\n\napp.get('/:page', (req, res) => {\n\tif(req.params.page=='tutoring')\n\t\treturn res.redirect('/forum');\n\tif(pages.find((page) => page.url==req.params.page))\n\t\trender(req, res, req.params.page);\n\telse\n\t\tres.redirect(\"/index\");\n});\n\napp.listen(5765);\n"]}